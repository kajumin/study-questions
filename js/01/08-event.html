<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
	<div class="box"><p>中国</p></div>
	<input type="text" name="username">
<!-- 
1.编写一个通用的事件监听函数
2.事件冒泡流程   三个阶段：事件捕捉，目标阶段，事件冒泡
3.无限事件下拉加载,给动态添加的图片绑定事件  =>事件委托 依赖于事件冒泡实现
 -->

 <script type="text/javascript">
 	function addEvent(dom,type,fn) {
 		if(addEventListener) {
			dom.addEventListener(type,fn);
 		}else if(attachEvent) {
 			dom.attachEvent('on'+ type,fn);
 		}
 	}
 	
 	var box = document.querySelector('.box');
 	addEvent(box,'click',function(e) {
 		e.preventDefault();
 		console.log(e.currentTarget)
 		console.log(e.target)  //e.srcElement
 		console.log(e.target.nodeName  === 'DIV')  //事件委托的原理
 		console.log('被点击了')
 		console.log(e.eventPhase) //3
 	})


 	// 取消冒泡  e.stopPropatation();


 	// 事件委托 关键target.matches
 	function addEvent(dom,type,selector,fn) {
 		if(fn == null) {
 			fn = selector;
 			selector = null;
 		}
 		if(addEventListener) {
 			dom.addEventListener(type, function(e){
 				if(selector) {
	 				target = e.target;
	 				console.log(target)
	 				console.log(e.eventPhase) //3
	 				// console.log(target.matches)  //一个函数
	 				if(target.matches(selector)) {
	 					fn.call(target,e);
	 				}
	 			}else {
	 				// console.log(selector)
	 				fn(e);
	 			}
	 		});		
 		}else if(attachEvent) {
 			dom.attachEvent('on'+ type,fn);
 		}
 	}

 	addEvent(box,'click','p',function(e){
 		console.log(e.target) //<p>中国</>
 		console.log(this) //<p>中国</p>
 		console.log(e.currentTarget) //box
 		console.log(e.eventPhase) //3
 	})
 	// console.log('<p>123</p>'.matches('p'))

 	
 </script>
</body>
</html>