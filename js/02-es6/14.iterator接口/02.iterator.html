<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
	<div></div>
	<div></div>
	<div></div>
<script>
	var it = makeIterator(['a', 'b'])
	function makeIterator(array) {
		var nextIndex = 0;
		return {
			next() {
				return nextIndex < array.length ?
				{ value: array[nextIndex++], done: false } :
				{ value: undefined, done: true }
			}
		}
	}
	console.log(it.next())
	console.log(it.next())
	console.log(it.next())

	// 对象上部署iterator接口 遍历器生成方法

	class F {
		constructor(start, stop) {
			this.start = start
			this.stop = stop
		}

		[Symbol.iterator]() {
			return this
		}

		next () {
			// console.log(this.start)
			var start = this.start
			if(start < this.stop) {
				this.start++
				return {
					done: false, value: start
				}
			} 
			
			return { done: true, value:undefined }
		}
	}
	var f = new F(0, 3)
	console.log(f)

	for(let value of f) {
		console.log(value) //0 1 2
	}

	// 通过遍历器实现指针结构的例子
	function Obj(value) {
		this.value = value
		this.next = null
	}
	Obj.prototype[Symbol.iterator] = function() {
		
		var iterator = { next: next }
		var current = this
		console.log(current)

		function next() {
			if(current) {
				var value = current.value
				current = current.next
				return { done: false, value: value }
			} else {
				return { done: true, value: undefined }
			}
		}
		return iterator
	}
	var one = new Obj('one')
	var two = new Obj('two')
	var three = new Obj('three')
	one.next = two
	two.next = three
	for(let o of one) {
		console.log(o)
	}

	// 对象添加iterator接口的例子
	let obj = {
		data: [1, 2, 3],
		[Symbol.iterator]() {
			const current = this
			let index = 0
			console.log(this)
			return {
				next() {
					if(index < current.data.length) {
						return {
							value: current.data[index++],
							done: false
						}
					}
					return {
						value: undefined,
						done: true
					}
				}
			}
		}
	}
	for(let o of obj) {
		console.log(o) //1 2 3
	}

	var divs = document.querySelectorAll('div')
	console.log(divs)//nodeList
	console.log([...divs])
	for(let div of divs) {
		console.log(div)
	}

	// 遍历对象的iterator接口
	let obj2 = {
		a: 'a',
		b: 'b',
		[Symbol.iterator]() {
			const current = this
			const keys = Object.keys(this)
			let index = 0

			return {
				next() {
					if(index < keys.length) {
						return {
							value: keys[index++],
							done: false
						}
					}
					return {
						value: undefined,
						done: true
					}
				}
			}
		}
	}
	for(let o of obj2 ) {
		console.log(o) 
	}

</script>
</body>
</html>