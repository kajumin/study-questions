<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
 
	<!-- event loopå®ƒçš„æ‰§è¡Œé¡ºåºï¼š
	1.ä¸€å¼€å§‹æ•´ä¸ªè„šæœ¬ä½œä¸ºä¸€ä¸ªå®ä»»åŠ¡æ‰§è¡Œ
	2.æ‰§è¡Œè¿‡ç¨‹ä¸­åŒæ­¥ä»£ç ç›´æ¥æ‰§è¡Œï¼Œå®ä»»åŠ¡è¿›å…¥å®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå¾®ä»»åŠ¡è¿›å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—
	3.å½“å‰å®ä»»åŠ¡æ‰§è¡Œå®Œå‡ºé˜Ÿï¼Œæ£€æŸ¥å¾®ä»»åŠ¡åˆ—è¡¨ï¼Œæœ‰åˆ™ä¾æ¬¡æ‰§è¡Œï¼Œç›´åˆ°å…¨éƒ¨æ‰§è¡Œå®Œ
	    4.æ‰§è¡Œæµè§ˆå™¨UIçº¿ç¨‹çš„æ¸²æŸ“å·¥ä½œ
	    5.æ£€æŸ¥æ˜¯å¦æœ‰Web Workerä»»åŠ¡ï¼Œæœ‰åˆ™æ‰§è¡Œ 
	6.æ‰§è¡Œå®Œæœ¬è½®çš„å®ä»»åŠ¡ï¼Œå›åˆ°2ï¼Œä¾æ­¤å¾ªç¯ï¼Œç›´åˆ°å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡é˜Ÿåˆ—éƒ½ä¸ºç©º -->
	<!-- å¾®ä»»åŠ¡ promise.then .catch process.nextTick  mutationObserver  -->
<!--
	1. æ²¡æœ‰resolve() reject() promiseçŠ¶æ€ä¸ºpending  Promise{<pending>}
	2. å°†promiseçš„çŠ¶æ€æ”¹ä¸ºäº†resolvedå¹¶ä¸”å°†å€¼ä¿å­˜ä¸‹, é‡åˆ°.thenå†æŠŠå®ƒæ·»åŠ è¿›å¾®ä»»åŠ¡é˜Ÿåˆ—
	3. æ²¡æœ‰resolve()  .thenä¸ä¼šæ‰§è¡Œ
	4. .thençš„è¿”å›å€¼æ˜¯æ–°çš„promiseå¯¹è±¡Promise{<pending>}
	5. .thenå¾®ä»»åŠ¡ä¼˜å…ˆäºsetTimeoutå®ä»»åŠ¡æ‰§è¡Œ
	6.  Promise.thenæ˜¯å¾®ä»»åŠ¡ï¼Œå®ƒä¼šè¢«åŠ å…¥åˆ°æœ¬è½®ä¸­çš„å¾®ä»»åŠ¡åˆ—è¡¨ï¼Œè€Œå®šæ—¶å™¨timer3æ˜¯å®ä»»åŠ¡ï¼Œå®ƒä¼šè¢«åŠ å…¥åˆ°ä¸‹ä¸€è½®çš„å®ä»»åŠ¡ä¸­ã€‚
	7. promise å†…éƒ¨çŠ¶æ€ä¸€ç»æ”¹å˜ï¼Œå¹¶ä¸”æœ‰äº†ä¸€ä¸ªå€¼ï¼Œé‚£ä¹ˆåç»­æ¯æ¬¡(å¤šæ¬¡)è°ƒç”¨ .then æˆ–è€… .catch éƒ½ä¼šç›´æ¥æ‹¿åˆ°è¯¥å€¼
-->
<!--
	1. Promiseçš„çŠ¶æ€ä¸€ç»æ”¹å˜å°±ä¸èƒ½å†æ”¹å˜ã€‚(è§3.1)
	2. .thenå’Œ.catchéƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„Promiseã€‚(ä¸Šé¢çš„ğŸ‘†1.4è¯æ˜äº†)
	3. catchä¸ç®¡è¢«è¿æ¥åˆ°å“ªé‡Œ, éƒ½èƒ½æ•è·ä¸Šå±‚çš„é”™è¯¯ã€‚(è§3.2)
	4. åœ¨Promiseä¸­ï¼Œè¿”å›ä»»æ„ä¸€ä¸ªé promise çš„å€¼éƒ½ä¼šè¢«åŒ…è£¹æˆ promise å¯¹è±¡ï¼Œä¾‹å¦‚return 2ä¼šè¢«åŒ…è£…ä¸ºreturn Promise.resolve(2)ã€‚
	5. Promise çš„ .then æˆ–è€… .catch å¯ä»¥è¢«è°ƒç”¨å¤šæ¬¡, å½“å¦‚æœPromiseå†…éƒ¨çš„çŠ¶æ€ä¸€ç»æ”¹å˜ï¼Œå¹¶ä¸”æœ‰äº†ä¸€ä¸ªå€¼ï¼Œé‚£ä¹ˆåç»­æ¯æ¬¡è°ƒç”¨.thenæˆ–è€….catchçš„æ—¶å€™éƒ½ä¼šç›´æ¥æ‹¿åˆ°è¯¥å€¼ã€‚(è§3.5)
	6. .then æˆ–è€… .catch ä¸­ return ä¸€ä¸ª error å¯¹è±¡å¹¶ä¸ä¼šæŠ›å‡ºé”™è¯¯ï¼Œæ‰€ä»¥ä¸ä¼šè¢«åç»­çš„ .catch æ•è·ã€‚(è§3.6)
	7. .then æˆ– .catch è¿”å›çš„å€¼ä¸èƒ½æ˜¯ promise æœ¬èº«ï¼Œå¦åˆ™ä¼šé€ æˆæ­»å¾ªç¯ã€‚(è§3.7)
	8. .then æˆ–è€… .catch çš„å‚æ•°æœŸæœ›æ˜¯å‡½æ•°, ä¼ å…¥éå‡½æ•°åˆ™ä¼šå‘ç”Ÿå€¼ç©¿é€ã€‚(è§3.8)
	9. .thenæ–¹æ³•æ˜¯èƒ½æ¥æ”¶ä¸¤ä¸ªå‚æ•°çš„ï¼Œç¬¬ä¸€ä¸ªæ˜¯å¤„ç†æˆåŠŸçš„å‡½æ•°ï¼Œç¬¬äºŒä¸ªæ˜¯å¤„ç†å¤±è´¥çš„å‡½æ•°ï¼Œå†æŸäº›æ—¶å€™ä½ å¯ä»¥è®¤ä¸ºcatchæ˜¯.thenç¬¬äºŒä¸ªå‚æ•°çš„ç®€ä¾¿å†™æ³•ã€‚(è§3.9)
	10. .finallyæ–¹æ³•ä¹Ÿæ˜¯è¿”å›ä¸€ä¸ªPromiseï¼Œä»–åœ¨Promiseç»“æŸçš„æ—¶å€™ï¼Œæ— è®ºç»“æœä¸ºresolvedè¿˜æ˜¯rejectedï¼Œéƒ½ä¼šæ‰§è¡Œé‡Œé¢çš„å›è°ƒå‡½æ•°
	11. 
	(1) .finally()æ–¹æ³•ä¸ç®¡Promiseå¯¹è±¡æœ€åçš„çŠ¶æ€å¦‚ä½•éƒ½ä¼šæ‰§è¡Œ
	(2) .finally()æ–¹æ³•çš„å›è°ƒå‡½æ•°ä¸æ¥å—ä»»ä½•çš„å‚æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ åœ¨.finally()å‡½æ•°ä¸­æ˜¯æ²¡æ³•çŸ¥é“Promiseæœ€ç»ˆçš„çŠ¶æ€æ˜¯resolvedè¿˜æ˜¯rejectedçš„
	(3) å®ƒæœ€ç»ˆè¿”å›çš„é»˜è®¤ä¼šæ˜¯ä¸€ä¸ªåŸæ¥çš„Promiseå¯¹è±¡å€¼ï¼Œä¸è¿‡å¦‚æœæŠ›å‡ºçš„æ˜¯ä¸€ä¸ªå¼‚å¸¸åˆ™è¿”å›å¼‚å¸¸çš„Promiseå¯¹è±¡ã€‚
	12.
	(1) Promise.all()çš„ä½œç”¨æ˜¯æ¥æ”¶ä¸€ç»„å¼‚æ­¥ä»»åŠ¡ï¼Œç„¶åå¹¶è¡Œæ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ï¼Œå¹¶ä¸”åœ¨æ‰€æœ‰å¼‚æ­¥æ“ä½œæ‰§è¡Œå®Œåæ‰æ‰§è¡Œå›è°ƒã€‚
	(2) .race()çš„ä½œç”¨ä¹Ÿæ˜¯æ¥æ”¶ä¸€ç»„å¼‚æ­¥ä»»åŠ¡ï¼Œç„¶åå¹¶è¡Œæ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ï¼Œåªä¿ç•™å–ç¬¬ä¸€ä¸ªæ‰§è¡Œå®Œæˆçš„å¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œå…¶ä»–çš„æ–¹æ³•ä»åœ¨æ‰§è¡Œï¼Œä¸è¿‡æ‰§è¡Œç»“æœä¼šè¢«æŠ›å¼ƒã€‚
	(3) Promise.all().then()ç»“æœä¸­æ•°ç»„çš„é¡ºåºå’ŒPromise.all()æ¥æ”¶åˆ°çš„æ•°ç»„é¡ºåºä¸€è‡´ã€‚
 -->
<div class="box" style="width: 100px;height:100px;background-color: red;"></div>
<script type="text/javascript">
	// const promise1 = new Promise((resolve, reject) => {
	//   console.log('promise1')
	//   resolve('resolve1')
	// })
	// const promise2 = promise1.then(res => {
	//   console.log(res)
	// })
	// console.log('1', promise1);
	// console.log('2', promise2);

	// const fn = () =>
	//   new Promise((resolve, reject) => {
	//     console.log(1);
	//     resolve("success");
	//   });

	// console.log("start");
	// fn().then(res => {
	//   console.log(res);
	// });
	//start 1 success


	// const promise = new Promise((resolve, reject) => {
	//   console.log(1);
	//   setTimeout(() => {
	//     console.log("timerStart");
	//     resolve("success");
	//     console.log("timerEnd");
	//   }, 0);
	//   console.log(2);
	// });
	// promise.then((res) => {
	//   console.log(res);
	// });
	// console.log(4);
	// 1 2 4 timerStart timerEnd success

	// setTimeout(() => {
	//   console.log('4');
	//   setTimeout(() => {
	//     console.log('3')
	//   }, 0)
	// }, 0)
	// setTimeout(() => {
	//   console.log('2')
	// }, 0)
	// console.log('1')
	// // 1 4 2 3

	// setTimeout(() => {
	//   console.log('5');
	//   Promise.resolve().then(() => {
	//     console.log('6')
	//   })
	// }, 0)
	// setTimeout(() => {
	//   console.log('7')
	// }, 0)
	// console.log('8')
	// 8 5 6 7

	// Promise.resolve().then(() => {
	//   console.log('1');
	//   const timer2 = setTimeout(() => {
	//     console.log('2')
	//   }, 0)
	// });
	// const timer1 = setTimeout(() => {
	//   console.log('3')
	//   Promise.resolve().then(() => {
	//     console.log('4')
	//   })
	// }, 0)
	// console.log('5');
	// 5 1 3 4 2

	// const promise1 = new Promise((resolve, reject) => {
	// 	setTimeout(() => {
	// 	    resolve('success')
	// 	}, 1000)
	// })
	// const promise2 = promise1.then(() => {
	//   throw new Error('error!!!')
	// })
	// console.log('promise1', promise1) //pending
	// console.log('promise2', promise2) //pending
	// setTimeout(() => {
	//   	console.log('promise1', promise1) //resolve
	//   	console.log('promise2', promise2) //error
	// }, 2000) 


	// const promise1 = new Promise((resolve, reject) => {
	//   setTimeout(() => {
	//     resolve("1");
	//     console.log("2");
	//   }, 1000);
	//   console.log("3");
	// });
	// const promise2 = promise1.then(() => {
	//   throw new Error("4");
	// });
	// console.log("5", promise1);
	// console.log("6", promise2);
	// setTimeout(() => {
	//   console.log("7");
	//   console.log("8", promise1);
	//   console.log("9", promise2);
	// }, 2000);
	// 3 5 6 2 4 7 8 9  

	// Promise.resolve('1')
	//   .then(res => {
	//     console.log(res)
	//   })
	//   .finally(() => {
	//     console.log('2')
	//   })
	// Promise.resolve('3')
	//   .finally(() => {
	//     console.log('4')
	//   	return '5'
	//   })
	//   .then(res => {
	//     console.log(res)
	//   })
	//   .then((res) => {
	//   	console.log(res)
	//   })
	// 1 4 2 3  undefined

	// Promise.resolve('1')
	//   .finally(() => {
	//     console.log('2')
	//     throw new Error('3')
	//   })
	//   .then(res => {
	//     console.log(res)
	//   })
	//   .catch(err => {
	//     console.log(err)
	//   })
	// // 2 3

	// function promise1 () {
	//   let p = new Promise((resolve) => {
	//     console.log('1');
	//     resolve('2')
	//   })
	//   return p;
	// }
	// function promise2 () {
	//   return new Promise((resolve, reject) => {
	//     reject('3')
	//   })
	// }
	// promise1()
	//   .then(res =>console.log(res))
	//   .catch(err =>console.log(err))
	//   .finally(() =>console.log('4'))

	// promise2()
	//   .then(res =>console.log(res))
	//   .catch(err =>console.log(err))
	//   .finally(() =>console.log('5'))
	//1 2 3 4 5

	// function promise1 () {
	//   let p = new Promise((resolve) => {
	//     console.log('1');
	//     resolve('2')
	//   })
	//   return p;
	// }
	// function promise2 () {
	//   return new Promise((resolve, reject) => {
	//     reject('3')
	//   })
	// }
	// promise1()
	//   .then(res =>console.log(res))
	//   .catch(err =>console.log(err))
	//   .then(() =>console.log('4'))

	// promise2()
	//   .then(res =>console.log(res))
	//   .catch(err =>console.log(err))
	//   .then(() =>console.log('5'))
	// //1 2 3  4 5 

	// function runAsync (x) {
	// 	const p = new Promise(resolve => {
	// 		setTimeout(() => {
	// 			resolve(x, console.log(x))
	// 		}, 1000)
	// 	})
	// 	return p
		
	// }
	// Promise.all([runAsync(1), runAsync(2), runAsync(3)])
	//   .then(res => console.log(res))
	// 1,2,3 [1,2,3]

	// function runAsync (x) {
	//   const p = new Promise(resolve => setTimeout(() => resolve(x, console.log(x)), 1000))
	//   return p
	// }
	// function runReject (x) {
	//   const p = new Promise((res, rej) => setTimeout(() => rej(`Error: ${x}`, console.log(x)), 1000 * x))
	//   return p
	// }
	// Promise.all([runAsync(1), runReject(4), runAsync(3), runReject(2)])
	//   .then(res =>console.log(res))
	//   .catch(err =>console.log(err))
	// 1 3 2 Error: 2   4


	// function runAsync (x) {
	//   const p = new Promise(r => setTimeout(() => r(x, console.log(x)), 1000))
	//   return p
	// }
	// Promise.race([runAsync(1), runAsync(2), runAsync(3)])
	//   .then(res =>console.log('result: ', res))
	//   .catch(err =>console.log(err))
	// 1 result: 1  2 3 

	// function runAsync(x) {
	//   const p = new Promise(r =>
	//     setTimeout(() => r(x, console.log(x)), 1000)
	//   );
	//   return p;
	// }
	// function runReject(x) {
	//   const p = new Promise((res, rej) =>
	//     setTimeout(() => rej(`Error: ${x}`, console.log(x)), 1000 * x)
	//   );
	//   return p;
	// }
	// Promise.race([runReject(0), runAsync(1), runAsync(2), runAsync(3)])
	//   .then(res =>console.log("result: ", res))
	//   .catch(err =>console.log(err));
	// 0 (Error: 0) 1 2 3

	// async function async1() {
	//   console.log("1");
	//   await async2();
	//   console.log("2");
	// }
	// async function async2() {
	//   console.log("3");
	// }
	// async1();
	// console.log('4')
	//4 1 3 2
	// ç„¶åè·³å‡ºasync1  è·³å‡ºasync1å‡½æ•°å(è®©å‡ºçº¿ç¨‹), æ‰§è¡ŒåŒæ­¥ä»£ç start,

	// async function async1() {
	//   console.log("5");
	//   new Promise(resolve => {
	//     console.log('6')
	//   })
	//   console.log("7");
	// }
	// async1();
	// console.log("8")
	// 8 5 6 7

	// async function async1() {
	//   console.log("1");
	//   await async2();
	//   console.log("2");
	// }
	// async function async2() {
	//   setTimeout(() => {
	//     console.log('3')
	//   }, 0)
	//   console.log("4");
	// }
	// async1();
	// console.log("5")
	// 1 4 5 2 3

	// async function async1() {
	//   console.log("1");
	//   await async2();
	//   console.log("2");
	//   setTimeout(() => {
	//     console.log('3')
	//   }, 0)
	// }
	// async function async2() {
	//   setTimeout(() => {
	//     console.log('4')
	//   }, 0)
	//   console.log("5");
	// }
	// async1();
	// setTimeout(() => {
	//   console.log('6')
	// }, 0)
	// console.log("7")
	// 1 5 7 2 4 6 3

	// async function async1 () {
	//   console.log('1');
	//   await new Promise(resolve => {
	//     console.log('2')
	//   })
	//   console.log('3');
	//   return '4'
	// }
	// console.log('5')
	// async1().then(res =>console.log(res))
	// console.log('6')
	// 5 1 2 6 
	// 3 4 æ²¡æœ‰è¾“å‡º  ä¸€ç›´pendingçŠ¶æ€ ä¸èƒ½æ‰§è¡Œåé¢çš„

	// async function async1 () {
	//   console.log('1');
	//   await new Promise(resolve => {
	//     console.log('2')
	//     resolve('3')
	//   }).then(res =>console.log(res))
	//   console.log('4');
	//   return '5'
	// }
	// console.log('6')
	// async1().then(res =>console.log(res))
	// console.log('7')
	// 6 1 2 7 3 4 5 

	// async function async1 () {
	//   console.log('1');
	//   await new Promise(resolve => {
	//     console.log('2')
	//     resolve('3')
	//   })
	//   console.log('4');
	//   return '5'
	// }
	// console.log('6')
	// async1().then(res => {
	//   console.log(res)
	// })
	// new Promise(resolve => {
	//   console.log('7')
	//   setTimeout(() => {
	//     console.log('8')
	//   })
	// })
	// 6 1 2 7 4 5 8

	// async function async1() {
	//   console.log("1");
	//   await async2();
	//   console.log("2");
	// }
	// async function async2() {
	//   console.log("3");
	// }
	// console.log("4");
	// setTimeout(function() {
	//   console.log("5");
	// }, 0);
	// async1();
	// new Promise(function(resolve) {
	//   console.log("6");
	//   resolve();
	// }).then(function() {
	//   console.log("7");
	// });
	// console.log('8')
	// 4 1 3 6 8 2 7 5
	// asyncé»˜è®¤è¿”å›promiseå‡½æ•°

	// async function testSometing() {
	//   console.log("1");
	//   return "2";
	// }
	// async function testAsync() {
	//   console.log("3");
	//   return Promise.resolve("4");
	// }
	// async function test() {
	//   console.log("5");
	//   const v1 = await testSometing();
	//   console.log(v1);
	//   const v2 = await testAsync();
	//   console.log(v2);
	//   console.log(v1, v2);
	// }
	// test();
	// var promise = new Promise(resolve => {
	//   console.log("6");
	//   resolve("7");
	// });
	// promise.then(val =>console.log(val));
	// console.log("8");
	// 5 1 6 8 2 3 7 4 (24)

	// async function async1 () {
	//   await async2();
	//   console.log('1');
	//   return '2'
	// }
	// async function async2 () {
	//   return new Promise((resolve, reject) => {
	//     console.log('3')
	//     reject('4')
	//     // throw new Error('4') //ä¸€æ ·
	//   })
	// }
	// async1().then(res =>console.log(res))
	// 3 
	// å¦‚æœåœ¨asyncå‡½æ•°ä¸­æŠ›å‡ºäº†é”™è¯¯ï¼Œåˆ™ç»ˆæ­¢é”™è¯¯ç»“æœï¼Œä¸ä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚

	// async function async1 () {
	//   try {
	//     await Promise.reject('1').catch(err => console.log(err))
	//   } catch(e) {
	//     // console.log(e)
	//   }
	//   console.log('2');
	//   return Promise.resolve('3')
	// }
	// async1().then(res =>console.log(res))
	// console.log('4')
	// 4 1 2 3
	// å› ä¸ºawait æ‰€ä»¥2æ²¡æœ‰å…ˆæ‰§è¡Œ 

	// const first = () => (new Promise((resolve, reject) => {
	//     console.log(3);
	//     let p = new Promise((resolve, reject) => {
	//         console.log(7);
	//         setTimeout(() => {
	//             console.log(5);
	//             resolve(6);
	//           	console.log(p)
	//         }, 0)
	//         resolve(1);
	//     });
	//     resolve(2);
	//     p.then((arg) => {
	//         console.log(arg);
	//     });

	// }));
	// first().then((arg) => {
	//     console.log(arg);
	// });
	// console.log(4);
	// 3 7 4 1 2 5 Promise {<resolve>: 1}

	// const async1 = async () => {
	//   console.log('1');
	//   setTimeout(() => {
	//     console.log('2')
	//   }, 2000)
	//   await new Promise(resolve => {
	//     console.log('3')
	//   })
	//   console.log('4')
	//   return '5'
	// }
	// console.log('6');
	// async1().then(res =>console.log(res));
	// console.log('7');
	// Promise.resolve(1)
	//   .then(2)
	//   .then(Promise.resolve(3))
	//   .catch(4)
	//   .then(res =>console.log(res))
	// setTimeout(() => {
	//   console.log('8')
	// }, 1000)
	// 6 1 3 7 1 8 2
	// ç¬¬äºŒä¸ª1æ˜¯å› ä¸ºç©¿é€ 45 æ²¡æœ‰è¾“å‡ºæ˜¯å› ä¸ºpromiseæ²¡æœ‰è½¬å˜çŠ¶æ€

	// const p1 = new Promise((resolve) => {
	//   setTimeout(() => {
	//     resolve('1');
	//     console.log('2')
	//   }, 0)
	//   resolve('3');
	//   resolve('4');
	// }).then(res => {
	//   console.log(res)
	//   setTimeout(() => {
	//     console.log(p1)
	//   }, 1000)
	// }).finally(res => {
	//   console.log(res)
	// })
	// 3 undefined 2 Promise {<pending>} 

	// const arr = [1, 2, 3]
	// arr.reduce((p, x) => {
	//   return p.then(() => {
	//     return new Promise(resolve => {
	//       setTimeout(() => resolve(console.log(x)), 1000)
	//     })
	//   })
	// }, Promise.resolve())
	// p.then.then.then
	// 1 2 3



	// var box = document.querySelector('.box')
	// new Promise((resolve, reject) => {
	// 	resolve()
	// }).then(res => {
	// 	console.log(box.style.width)
	// 	box.style.width = 300 + 'px'
	// }).then(() => {
	// 	console.log(box.style.width)
	// })
	// // setTimeout(()=>{
	// // 	console.log(box.style.width)
	// // }, 100)
	// box.style.width = 200 + 'px'


</script>
</body>
</html>